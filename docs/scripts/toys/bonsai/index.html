<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="bonsai"><meta property="og:title" content="bonsai"><meta property="og:description" content="Download  #!/usr/bin/env bash  # I'm a bonsai-making machine! ################################################# ## # author: John Allbritten # license: GPLv3 # repo: https://gitlab.com/jallbrit/bonsai.sh # # this script is constantly being updated, so # check repo for most up-to-date version. ## ################################################# # ------ vars ------ # CLI options live=0 infinite=0 nfetch=0 termSize=1 termColors=0 leafStrs='&' baseType=1 message=&#34;&#34; multiplier=5 lifeStart=28 timeStep=0.03 timeWait=4 flag_m=0 flag_h=0 # non-CLI options messageWidth=20 verbose=0 seed=&#34;$RANDOM&#34; # ensure locale is correct LC_ALL=&#34;en_US."><meta property="og:type" content="article"><meta property="og:url" content="https://hellupline.dev/docs/scripts/toys/bonsai/"><meta property="article:modified_time" content="2022-11-04T03:17:20-03:00"><title>bonsai | hellupline notes</title><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.829f7602029a29a47bf1b0c9c4bb52982089a6d13558c9433d3c8b7e38c8b3b8.css integrity="sha256-gp92AgKaKaR78bDJxLtSmCCJptE1WMlDPTyLfjjIs7g="><script defer src=/en.search.min.3bb1f00a14b29d98cd64ec345a2b3ad33ce40832d7778e7fcb6872d83be65085.js integrity="sha256-O7HwChSynZjNZOw0Wis60zzkCDLXd45/y2hy2DvmUIU="></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>hellupline notes</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><span>articles</span><ul><li><a href=/docs/articles/gallery/>gallery</a></li><li><a href=/docs/articles/todo/>todo</a></li></ul></li><li><span>cheatsheets</span><ul><li><a href=/docs/cheatsheets/aws/>aws</a></li><li><a href=/docs/cheatsheets/curl/>curl</a></li><li><a href=/docs/cheatsheets/desktop-linux/>desktop-linux</a></li><li><a href=/docs/cheatsheets/desktop-osx/>desktop-osx</a></li><li><a href=/docs/cheatsheets/docker/>docker</a></li><li><a href=/docs/cheatsheets/ffmpeg/>ffmpeg</a></li><li><a href=/docs/cheatsheets/find/>find</a></li><li><a href=/docs/cheatsheets/gpg/>gpg</a></li><li><a href=/docs/cheatsheets/kubernetes/>kubernetes</a></li><li><a href=/docs/cheatsheets/luks/>luks</a></li><li><a href=/docs/cheatsheets/mdadm/>mdadm</a></li><li><a href=/docs/cheatsheets/mysql/>mysql</a></li><li><a href=/docs/cheatsheets/network/>network</a></li><li><a href=/docs/cheatsheets/nginx/>nginx</a></li><li><a href=/docs/cheatsheets/openssl/>openssl</a></li><li><a href=/docs/cheatsheets/postgres/>postgres</a></li><li><a href=/docs/cheatsheets/python/>python</a></li><li><a href=/docs/cheatsheets/redshift/>redshift</a></li><li><a href=/docs/cheatsheets/ssh/>ssh</a></li><li><a href=/docs/cheatsheets/sysadmin/>sysadmin</a></li><li><a href=/docs/cheatsheets/utils/>utils</a></li></ul></li><li><span>configurations</span><ul><li><span>kubernetes</span><ul><li><a href=/docs/configurations/kubernetes/configmap/>configmap</a></li><li><a href=/docs/configurations/kubernetes/cronjob/>cronjob</a></li><li><a href=/docs/configurations/kubernetes/daemonset/>daemonset</a></li><li><a href=/docs/configurations/kubernetes/deployment/>deployment</a></li><li><a href=/docs/configurations/kubernetes/hpa/>hpa</a></li><li><a href=/docs/configurations/kubernetes/ingress/>ingress</a></li><li><a href=/docs/configurations/kubernetes/job/>job</a></li><li><a href=/docs/configurations/kubernetes/namespace/>namespace</a></li><li><a href=/docs/configurations/kubernetes/pod/>pod</a></li><li><a href=/docs/configurations/kubernetes/private-registry-credentials/>private-registry-credentials</a></li><li><a href=/docs/configurations/kubernetes/rbac-aggregated-maintenance/>rbac-aggregated-maintenance</a></li><li><a href=/docs/configurations/kubernetes/rbac-cluster-full-access/>rbac-cluster-full-access</a></li><li><a href=/docs/configurations/kubernetes/rbac-cluster-read-only/>rbac-cluster-read-only</a></li><li><a href=/docs/configurations/kubernetes/rbac-namespace-full-access/>rbac-namespace-full-access</a></li><li><a href=/docs/configurations/kubernetes/rbac-namespace-read-only/>rbac-namespace-read-only</a></li><li><a href=/docs/configurations/kubernetes/secret/>secret</a></li><li><a href=/docs/configurations/kubernetes/service/>service</a></li><li><a href=/docs/configurations/kubernetes/service-dns/>service-dns</a></li><li><a href=/docs/configurations/kubernetes/service-endpoint/>service-endpoint</a></li><li><a href=/docs/configurations/kubernetes/statefulset/>statefulset</a></li><li><a href=/docs/configurations/kubernetes/volume-cloud/>volume-cloud</a></li><li><a href=/docs/configurations/kubernetes/volume-local-disk/>volume-local-disk</a></li></ul></li><li><span>nginx</span><ul><li><a href=/docs/configurations/nginx/cached-proxy/>cached-proxy</a></li><li><a href=/docs/configurations/nginx/https/>https</a></li><li><a href=/docs/configurations/nginx/load-balancer/>load-balancer</a></li><li><a href=/docs/configurations/nginx/password/>password</a></li><li><a href=/docs/configurations/nginx/redirect/>redirect</a></li><li><a href=/docs/configurations/nginx/static-files/>static-files</a></li></ul></li></ul></li><li><span>scripts</span><ul><li><span>golang</span><ul><li><a href=/docs/scripts/golang/echoserver.go/>echoserver.go</a></li></ul></li><li><span>kubernetes</span><ul><li><a href=/docs/scripts/kubernetes/kubectl-context-list/>kubectl-context-list</a></li><li><a href=/docs/scripts/kubernetes/kubectl-context-set/>kubectl-context-set</a></li><li><a href=/docs/scripts/kubernetes/kubectl-ingress-health/>kubectl-ingress-health</a></li><li><a href=/docs/scripts/kubernetes/kubectl-namespace-list/>kubectl-namespace-list</a></li><li><a href=/docs/scripts/kubernetes/kubectl-namespace-set/>kubectl-namespace-set</a></li><li><a href=/docs/scripts/kubernetes/kubectl-pods-failed/>kubectl-pods-failed</a></li><li><a href=/docs/scripts/kubernetes/kubectl-shell/>kubectl-shell</a></li></ul></li><li><span>python</span><ul><li><a href=/docs/scripts/python/ftpython/>ftpython</a></li><li><a href=/docs/scripts/python/simple-https/>simple-https</a></li></ul></li><li><span>toys</span><ul><li><a href=/docs/scripts/toys/bonsai/ class=active>bonsai</a></li><li><a href=/docs/scripts/toys/colorbars/>colorbars</a></li><li><a href=/docs/scripts/toys/dna/>dna</a></li><li><a href=/docs/scripts/toys/food/>food</a></li><li><a href=/docs/scripts/toys/ghosts/>ghosts</a></li><li><a href=/docs/scripts/toys/invaders/>invaders</a></li><li><a href=/docs/scripts/toys/metroid/>metroid</a></li><li><a href=/docs/scripts/toys/pacman-colors/>pacman-colors</a></li><li><a href=/docs/scripts/toys/pipes/>pipes</a></li><li><a href=/docs/scripts/toys/pipesx/>pipesx</a></li><li><a href=/docs/scripts/toys/rain/>rain</a></li><li><a href=/docs/scripts/toys/ryu/>ryu</a></li><li><a href=/docs/scripts/toys/skull/>skull</a></li><li><a href=/docs/scripts/toys/slendy/>slendy</a></li></ul></li><li><span>utils</span><ul><li><a href=/docs/scripts/utils/blurlock/>blurlock</a></li><li><a href=/docs/scripts/utils/cached/>cached</a></li><li><a href=/docs/scripts/utils/clipboard-watch/>clipboard-watch</a></li><li><a href=/docs/scripts/utils/git-cleanup/>git-cleanup</a></li><li><a href=/docs/scripts/utils/lets-encrypt-cloudflare/>lets-encrypt-cloudflare</a></li><li><a href=/docs/scripts/utils/lets-encrypt-cname/>lets-encrypt-cname</a></li><li><a href=/docs/scripts/utils/make-cacert/>make-cacert</a></li><li><a href=/docs/scripts/utils/make-cacert-certificate/>make-cacert-certificate</a></li><li><a href=/docs/scripts/utils/make-selfsign-certificate/>make-selfsign-certificate</a></li><li><a href=/docs/scripts/utils/play-old/>play-old</a></li><li><a href=/docs/scripts/utils/play-random/>play-random</a></li><li><a href=/docs/scripts/utils/screenshot/>screenshot</a></li><li><a href=/docs/scripts/utils/show-certs/>show-certs</a></li><li><a href=/docs/scripts/utils/spotifyctl/>spotifyctl</a></li><li><a href=/docs/scripts/utils/tabular/>tabular</a></li><li><a href=/docs/scripts/utils/utcnow/>utcnow</a></li><li><a href=/docs/scripts/utils/wallpapers/>wallpapers</a></li></ul></li></ul></li></ul><ul><li><a href=https://github.com/hellupline target=_blank rel=noopener>Github</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>bonsai</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents></nav></aside></header><article class=markdown><div style=text-align:right><a href=/files/docs/scripts/toys/bonsai.sh>Download</a></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#75715e>#!/usr/bin/env bash
</span><span style=color:#75715e></span>
<span style=color:#75715e># I&#39;m a bonsai-making machine!</span>

<span style=color:#75715e>#################################################</span>
<span style=color:#75715e>##</span>
<span style=color:#75715e># author:  John Allbritten</span>
<span style=color:#75715e># license: GPLv3</span>
<span style=color:#75715e># repo:    https://gitlab.com/jallbrit/bonsai.sh</span>
#
<span style=color:#75715e>#  this script is constantly being updated, so</span>
<span style=color:#75715e>#  check repo for most up-to-date version.</span>
<span style=color:#75715e>##</span>
<span style=color:#75715e>#################################################</span>

<span style=color:#75715e># ------ vars ------</span>
<span style=color:#75715e># CLI options</span>

<span style=color:#111>live</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
<span style=color:#111>infinite</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
<span style=color:#111>nfetch</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>

<span style=color:#111>termSize</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
<span style=color:#111>termColors</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
<span style=color:#111>leafStrs</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;&amp;&#39;</span>
<span style=color:#111>baseType</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
<span style=color:#111>message</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;&#34;</span>

<span style=color:#111>multiplier</span><span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
<span style=color:#111>lifeStart</span><span style=color:#f92672>=</span><span style=color:#ae81ff>28</span>

<span style=color:#111>timeStep</span><span style=color:#f92672>=</span>0.03
<span style=color:#111>timeWait</span><span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>

<span style=color:#111>flag_m</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
<span style=color:#111>flag_h</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>

<span style=color:#75715e># non-CLI options</span>
<span style=color:#111>messageWidth</span><span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>
<span style=color:#111>verbose</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
<span style=color:#111>seed</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$RANDOM</span><span style=color:#d88200>&#34;</span>

<span style=color:#75715e># ensure locale is correct</span>
<span style=color:#111>LC_ALL</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;en_US.UTF-8&#34;</span>

<span style=color:#75715e># ensure Bash version &gt;= 4.0</span>
<span style=color:#00a8c8>if</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>BASH_VERSINFO<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> &lt; 4<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>Error: bonsai.sh requires Bash v4.0 or higher. You have version </span><span style=color:#111>$BASH_VERSION</span><span style=color:#d88200>.</span><span style=color:#d88200>&#34;</span>
<span style=color:#00a8c8>fi</span>

<span style=color:#75715e># ensure MacOS compatibility with GNU getopt</span>
<span style=color:#00a8c8>if</span> <span style=color:#f92672>[</span><span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$OSTYPE</span><span style=color:#d88200>&#34;</span> <span style=color:#f92672>=</span><span style=color:#f92672>=</span> <span style=color:#d88200>&#39;darwin&#39;</span>* <span style=color:#f92672>]</span><span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
    <span style=color:#111>GGETOPT</span><span style=color:#f92672>=</span>/usr/local/Cellar/gnu-getopt/*/bin/getopt <span style=color:#75715e># should find gnu-getopt</span>
    <span style=color:#00a8c8>if</span> <span style=color:#f92672>[</span> ! -x <span style=color:#111>$GGETOPT</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span> <span style=color:#75715e># file is not executable</span>
        <span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#39;Error: Running on MacOS requires an executable gnu getopt.&#39;</span>
        <span style=color:#111>exit</span> <span style=color:#ae81ff>2</span>
    <span style=color:#00a8c8>fi</span>
    <span style=color:#111>shopt</span> -s expand_aliases
    <span style=color:#111>alias</span> <span style=color:#111>getopt</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;$GGETOPT&#39;</span> <span style=color:#75715e># replace getopt with gnu getopt</span>
<span style=color:#00a8c8>fi</span>

<span style=color:#75715e># ------ parse options ------</span>

<span style=color:#111>OPTS</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;hlt:w:ig:c:Tm:b:M:L:s:vn&#34;</span>	<span style=color:#75715e># the colon means it requires a value</span>
<span style=color:#111>LONGOPTS</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;help,live,time:,wait:,infinite,geometry:,leaf:,termcolors,message:,base:,multiplier:,life:,seed:,verbose,neofetch&#34;</span>

<span style=color:#111>parsed</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$(</span>getopt --options<span style=color:#f92672>=</span><span style=color:#111>$OPTS</span> --longoptions<span style=color:#f92672>=</span><span style=color:#111>$LONGOPTS</span> -- <span style=color:#d88200>&#34;</span><span style=color:#111>$@</span><span style=color:#d88200>&#34;</span><span style=color:#00a8c8>)</span>
<span style=color:#111>eval</span> <span style=color:#111>set</span> -- <span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>parsed</span><span style=color:#111>[@]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span>

<span style=color:#00a8c8>while</span> true<span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
	<span style=color:#00a8c8>case</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$1</span><span style=color:#d88200>&#34;</span> in
		-h<span style=color:#111>|</span>--help<span style=color:#f92672>)</span>
			<span style=color:#111>flag_h</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
			<span style=color:#111>shift</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-l<span style=color:#111>|</span>--live<span style=color:#f92672>)</span>
			<span style=color:#111>live</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
			<span style=color:#111>shift</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-t<span style=color:#111>|</span>--time<span style=color:#f92672>)</span>
			<span style=color:#111>timeStep</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$2</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>2</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-w<span style=color:#111>|</span>--wait<span style=color:#f92672>)</span>
			<span style=color:#111>timeWait</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$2</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>2</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-g<span style=color:#111>|</span>--geometry<span style=color:#f92672>)</span>
			<span style=color:#111>termSize</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
			<span style=color:#111>geometry</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$2</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>2</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-c<span style=color:#111>|</span>--leaf<span style=color:#f92672>)</span>
			<span style=color:#111>leafStrs</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$2</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>2</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-T<span style=color:#111>|</span>--termcolors<span style=color:#f92672>)</span>
			<span style=color:#111>termColors</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
			<span style=color:#111>shift</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-m<span style=color:#111>|</span>--message<span style=color:#f92672>)</span>
			<span style=color:#111>flag_m</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
			<span style=color:#111>message</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$2</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>2</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-b<span style=color:#111>|</span>--base<span style=color:#f92672>)</span>
			<span style=color:#111>baseType</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$2</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>2</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-i<span style=color:#111>|</span>--infinite<span style=color:#f92672>)</span>
			<span style=color:#111>infinite</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>1</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-M<span style=color:#111>|</span>--multiplier<span style=color:#f92672>)</span>
			<span style=color:#111>multiplier</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$2</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>2</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-L<span style=color:#111>|</span>--life<span style=color:#f92672>)</span>
			<span style=color:#111>lifeStart</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$2</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>2</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-s<span style=color:#111>|</span>--seed<span style=color:#f92672>)</span>
			<span style=color:#111>RANDOM</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$2</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>2</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-v<span style=color:#111>|</span>--verbose<span style=color:#f92672>)</span>
			<span style=color:#111>verbose</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>1</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		-n<span style=color:#111>|</span>--neofetch<span style=color:#f92672>)</span>
			<span style=color:#111>nfetch</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
			<span style=color:#111>shift</span> <span style=color:#ae81ff>1</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		--<span style=color:#f92672>)</span> <span style=color:#75715e># end of arguments</span>
			<span style=color:#111>shift</span>
			<span style=color:#111>break</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>

		*<span style=color:#f92672>)</span>
			<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;error while parsing CLI options&#34;</span>
			<span style=color:#111>flag_h</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
			<span style=color:#111>;</span><span style=color:#111>;</span>
	<span style=color:#00a8c8>esac</span>
<span style=color:#00a8c8>done</span>

<span style=color:#75715e># ------ check input ------</span>

<span style=color:#75715e># ensure integer values</span>
<span style=color:#00a8c8>if</span> ! <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$lifeStart</span><span style=color:#d88200>&#34;</span> -eq <span style=color:#d88200>&#34;</span><span style=color:#111>$lifeStart</span><span style=color:#d88200>&#34;</span> 2&gt; /dev/null <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>--life (</span><span style=color:#111>$lifeStart</span><span style=color:#d88200>) invalid: must be an integer</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#111>exit</span> <span style=color:#ae81ff>1</span>

<span style=color:#00a8c8>elif</span> ! <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$multiplier</span><span style=color:#d88200>&#34;</span> -eq <span style=color:#d88200>&#34;</span><span style=color:#111>$multiplier</span><span style=color:#d88200>&#34;</span> 2&gt; /dev/null <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>--multiplier (</span><span style=color:#111>$multiplier</span><span style=color:#d88200>) invalid: must be an integer</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#111>exit</span> <span style=color:#ae81ff>1</span>

<span style=color:#00a8c8>elif</span> ! <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$baseType</span><span style=color:#d88200>&#34;</span> -eq <span style=color:#d88200>&#34;</span><span style=color:#111>$baseType</span><span style=color:#d88200>&#34;</span> 2&gt; /dev/null <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>--base (</span><span style=color:#111>$baseType</span><span style=color:#d88200>) invalid: must be an integer</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#111>exit</span> <span style=color:#ae81ff>1</span>

<span style=color:#75715e># ensure ranges</span>
<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$baseType</span><span style=color:#d88200>&#34;</span> -lt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>--base (</span><span style=color:#111>$baseType</span><span style=color:#d88200>) invalid: out of range</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#111>exit</span> <span style=color:#ae81ff>1</span>

<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$lifeStart</span><span style=color:#d88200>&#34;</span> -lt <span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$lifeStart</span><span style=color:#d88200>&#34;</span> -gt <span style=color:#ae81ff>200</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>--life (</span><span style=color:#111>$lifeStart</span><span style=color:#d88200>) invalid: out of range</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#111>exit</span> <span style=color:#ae81ff>1</span>

<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$multiplier</span><span style=color:#d88200>&#34;</span> -lt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$multiplier</span><span style=color:#d88200>&#34;</span> -gt <span style=color:#ae81ff>20</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>--multiplier (</span><span style=color:#111>$multiplier</span><span style=color:#d88200>) invalid: out of range</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#111>exit</span> <span style=color:#ae81ff>1</span>

<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$seed</span><span style=color:#d88200>&#34;</span> -lt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$seed</span><span style=color:#d88200>&#34;</span> -gt <span style=color:#ae81ff>32767</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>--seed (</span><span style=color:#111>$seed</span><span style=color:#d88200>) invalid: out of range</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#111>exit</span> <span style=color:#ae81ff>1</span>

<span style=color:#75715e># ensure floats are less than 0</span>
<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span><span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$timeStep</span><span style=color:#d88200> &lt; 0</span><span style=color:#d88200>&#34;</span> <span style=color:#111>|</span> bc -l<span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span> -eq <span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>--timestep (</span><span style=color:#111>$timeStep</span><span style=color:#d88200>) invalid: out of range</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#111>exit</span> <span style=color:#ae81ff>1</span>

<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span><span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$timeWait</span><span style=color:#d88200> &lt; 0</span><span style=color:#d88200>&#34;</span> <span style=color:#111>|</span> bc -l<span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span> -eq <span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>--wait (</span><span style=color:#111>$timeWait</span><span style=color:#d88200>) invalid: out of range</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#111>exit</span> <span style=color:#ae81ff>1</span>
<span style=color:#00a8c8>fi</span>

<span style=color:#111>HELP</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;\
</span><span style=color:#d88200>Usage: bonsai [OPTIONS]
</span><span style=color:#d88200>
</span><span style=color:#d88200>bonsai.sh is a beautifully random bonsai tree generator.
</span><span style=color:#d88200>
</span><span style=color:#d88200>optional args:
</span><span style=color:#d88200>  -l, --live             live mode
</span><span style=color:#d88200>  -t, --time TIME        in live mode, minimum time in secs between
</span><span style=color:#d88200>                           steps of growth [default: 0.03]
</span><span style=color:#d88200>  -i, --infinite         infinite mode
</span><span style=color:#d88200>  -w, --wait TIME        in infinite mode, time in secs between
</span><span style=color:#d88200>                           tree generation [default: 4]
</span><span style=color:#d88200>  -n, --neofetch         neofetch mode
</span><span style=color:#d88200>  -m, --message STR      attach message next to the tree
</span><span style=color:#d88200>  -T, --termcolors       use terminal colors
</span><span style=color:#d88200>  -g, --geometry X,Y     set custom geometry
</span><span style=color:#d88200>  -b, --base INT         ascii-art plant base to use, 0 is none
</span><span style=color:#d88200>  -c, --leaf STR1,STR2,STR3...   list of strings randomly chosen for leaves
</span><span style=color:#d88200>  -M, --multiplier INT   branch multiplier; higher -&gt; more
</span><span style=color:#d88200>                           branching (0-20) [default: 5]
</span><span style=color:#d88200>  -L, --life INT         life; higher -&gt; more growth (0-200) [default: 28]
</span><span style=color:#d88200>  -s, --seed INT         seed random number generator (0-32767)
</span><span style=color:#d88200>  -v, --verbose          print information each step of generation
</span><span style=color:#d88200>  -h, --help             show help&#34;</span>

<span style=color:#00a8c8>if</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>flag_h<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$HELP</span><span style=color:#d88200>&#34;</span>
	<span style=color:#111>exit</span> <span style=color:#ae81ff>0</span>
<span style=color:#00a8c8>fi</span>

<span style=color:#111>shopt</span> -s checkwinsize 	<span style=color:#75715e># allows variables $COLUMNS/$LINES to be used</span>

<span style=color:#111>trap</span> <span style=color:#d88200>&#39;quit&#39;</span> SIGINT	<span style=color:#75715e># respond to CTRL+C</span>
<span style=color:#111>trap</span> <span style=color:#d88200>&#39;setGeometry&#39;</span> WINCH	<span style=color:#75715e># respond to window resize</span>

<span style=color:#111>IFS</span><span style=color:#f92672>=</span><span style=color:#d88200>$&#39;\n&#39;</span>	<span style=color:#75715e># delimit by newline</span>
<span style=color:#f92672>(</span><span style=color:#f92672>(</span>! nfetch<span style=color:#f92672>)</span><span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> tabs <span style=color:#ae81ff>4</span>

<span style=color:#75715e># define colors</span>
<span style=color:#00a8c8>if</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>termColors<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>LightBrown</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[1;33m&#39;</span>
	<span style=color:#111>DarkBrown</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[0;33m&#39;</span>
	<span style=color:#111>BrownGreen</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[1;32m&#39;</span>
	<span style=color:#111>Green</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[0;32m&#39;</span>
	<span style=color:#111>Gray</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[1;30m&#39;</span>
<span style=color:#00a8c8>elif</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>nfetch<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
	<span style=color:#111>LightBrown</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;${c1}&#39;</span>
	<span style=color:#111>DarkBrown</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;${c2}&#39;</span>
	<span style=color:#111>BrownGreen</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;${c3}&#39;</span>
	<span style=color:#111>Green</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;${c4}&#39;</span>
	<span style=color:#111>Gray</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;${c5}&#39;</span>
<span style=color:#00a8c8>else</span>
	<span style=color:#111>LightBrown</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[38;5;172m&#39;</span>
	<span style=color:#111>DarkBrown</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[38;5;130m&#39;</span>
	<span style=color:#111>BrownGreen</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[38;5;142m&#39;</span>
	<span style=color:#111>Green</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[38;5;106m&#39;</span>
	<span style=color:#111>Gray</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[38;5;243m&#39;</span>
<span style=color:#00a8c8>fi</span>
<span style=color:#111>R</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;\e[0m&#39;</span>

<span style=color:#75715e># create ascii base in lines</span>
<span style=color:#00a8c8>case</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$baseType</span><span style=color:#d88200>&#34;</span> in
	1<span style=color:#f92672>)</span>
		<span style=color:#111>width</span><span style=color:#f92672>=</span><span style=color:#ae81ff>15</span>
		<span style=color:#111>art</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>\
</span><span style=color:#d88200></span><span style=color:#d88200>${</span><span style=color:#111>Gray</span><span style=color:#d88200>}</span><span style=color:#d88200>:</span><span style=color:#d88200>${</span><span style=color:#111>Green</span><span style=color:#d88200>}</span><span style=color:#d88200>___________</span><span style=color:#d88200>${</span><span style=color:#111>DarkBrown</span><span style=color:#d88200>}</span><span style=color:#d88200>./~~\\.</span><span style=color:#d88200>${</span><span style=color:#111>Green</span><span style=color:#d88200>}</span><span style=color:#d88200>___________</span><span style=color:#d88200>${</span><span style=color:#111>Gray</span><span style=color:#d88200>}</span><span style=color:#d88200>:
</span><span style=color:#d88200> \\                          /
</span><span style=color:#d88200>  \\________________________/
</span><span style=color:#d88200>  (_)                    (_)</span><span style=color:#d88200>&#34;</span>
		<span style=color:#111>;</span><span style=color:#111>;</span>

	2<span style=color:#f92672>)</span>
		<span style=color:#111>width</span><span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>
		<span style=color:#111>art</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>\
</span><span style=color:#d88200></span><span style=color:#d88200>${</span><span style=color:#111>Gray</span><span style=color:#d88200>}</span><span style=color:#d88200>(</span><span style=color:#d88200>${</span><span style=color:#111>Green</span><span style=color:#d88200>}</span><span style=color:#d88200>---</span><span style=color:#d88200>${</span><span style=color:#111>DarkBrown</span><span style=color:#d88200>}</span><span style=color:#d88200>./~~\\.</span><span style=color:#d88200>${</span><span style=color:#111>Green</span><span style=color:#d88200>}</span><span style=color:#d88200>---</span><span style=color:#d88200>${</span><span style=color:#111>Gray</span><span style=color:#d88200>}</span><span style=color:#d88200>)
</span><span style=color:#d88200> (          )
</span><span style=color:#d88200>  (________)</span><span style=color:#d88200>&#34;</span>
		<span style=color:#111>;</span><span style=color:#111>;</span>

	3<span style=color:#f92672>)</span>
		<span style=color:#111>width</span><span style=color:#f92672>=</span><span style=color:#ae81ff>15</span>
		<span style=color:#111>art</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>\
</span><span style=color:#d88200></span><span style=color:#d88200>${</span><span style=color:#111>Gray</span><span style=color:#d88200>}</span><span style=color:#d88200>╓</span><span style=color:#d88200>${</span><span style=color:#111>Green</span><span style=color:#d88200>}</span><span style=color:#d88200>───────────</span><span style=color:#d88200>${</span><span style=color:#111>DarkBrown</span><span style=color:#d88200>}</span><span style=color:#d88200>╭╱⎨⏆╲╮</span><span style=color:#d88200>${</span><span style=color:#111>Green</span><span style=color:#d88200>}</span><span style=color:#d88200>───────────</span><span style=color:#d88200>${</span><span style=color:#111>Gray</span><span style=color:#d88200>}</span><span style=color:#d88200>╖
</span><span style=color:#d88200>║                            ║
</span><span style=color:#d88200>╟────────────────────────────╢
</span><span style=color:#d88200>╟────────────────────────────╢
</span><span style=color:#d88200>╚════════════════════════════╝</span><span style=color:#d88200>&#34;</span>
		<span style=color:#111>;</span><span style=color:#111>;</span>

	*<span style=color:#f92672>)</span>  <span style=color:#111>art</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;&#34;</span> <span style=color:#111>;</span><span style=color:#111>;</span>
<span style=color:#00a8c8>esac</span>

<span style=color:#75715e># get base height</span>
<span style=color:#111>baseHeight</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
<span style=color:#00a8c8>for</span> line in <span style=color:#111>$art</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
	<span style=color:#111>baseHeight</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span> baseHeight <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#00a8c8>))</span>
<span style=color:#00a8c8>done</span>

<span style=color:#75715e># create leafArray</span>
<span style=color:#111>declare</span> -A leafArray
<span style=color:#111>leafArrayLen</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
<span style=color:#75715e># parse each string in comma-separated $leafStrs</span>
<span style=color:#00a8c8>for</span> str in <span style=color:#d88200>${</span><span style=color:#111>leafStrs</span><span style=color:#111>//,/</span><span style=color:#d88200>$&#39;\n&#39;</span><span style=color:#d88200>}</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>

	leafArray<span style=color:#f92672>[</span><span style=color:#111>$leafArrayLen</span>,0<span style=color:#f92672>]</span><span style=color:#f92672>=</span><span style=color:#d88200>${#</span><span style=color:#111>str</span><span style=color:#d88200>}</span> 	<span style=color:#75715e># first item in sub-array is length</span>

	<span style=color:#75715e># for character in string, add to the sub-array</span>
	<span style=color:#00a8c8>for</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span> <span style=color:#111>i</span><span style=color:#f92672>=</span>0<span style=color:#111>;</span> i &lt; <span style=color:#d88200>${#</span><span style=color:#111>str</span><span style=color:#d88200>}</span><span style=color:#111>;</span> i++ <span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
		leafArray<span style=color:#f92672>[</span><span style=color:#111>$leafArrayLen</span>,<span style=color:#00a8c8>$((</span>i+1<span style=color:#00a8c8>))</span><span style=color:#f92672>]</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>str</span><span style=color:#111>:</span><span style=color:#111>$i</span><span style=color:#111>:</span><span style=color:#111>1</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span>
	<span style=color:#00a8c8>done</span>
	<span style=color:#111>leafArrayLen</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>leafArrayLen+1<span style=color:#00a8c8>))</span>
<span style=color:#00a8c8>done</span>

setGeometry<span style=color:#f92672>(</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
	<span style=color:#00a8c8>if</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>nfetch<span style=color:#f92672>)</span><span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>termSize<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
		<span style=color:#111>geometry</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span>tput cols<span style=color:#00a8c8>)</span><span style=color:#d88200>,</span><span style=color:#00a8c8>$(</span>tput lines<span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span>	<span style=color:#75715e># geometry must use tput in this mode</span>
	<span style=color:#00a8c8>elif</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>termSize<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
		<span style=color:#111>geometry</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$COLUMNS</span><span style=color:#d88200>,</span><span style=color:#111>$LINES</span><span style=color:#d88200>&#34;</span>	<span style=color:#75715e># these vars automatically update</span>
	<span style=color:#00a8c8>fi</span>
	<span style=color:#111>cols</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span><span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$geometry</span><span style=color:#d88200>&#34;</span> <span style=color:#111>|</span> cut -d <span style=color:#d88200>&#39;,&#39;</span> -f1<span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span>	<span style=color:#75715e># width; X</span>
	<span style=color:#111>rows</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span><span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$geometry</span><span style=color:#d88200>&#34;</span> <span style=color:#111>|</span> cut -d <span style=color:#d88200>&#39;,&#39;</span> -f2<span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span>	<span style=color:#75715e># height; Y</span>

	<span style=color:#111>rows</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>rows <span style=color:#f92672>-</span> baseHeight<span style=color:#00a8c8>))</span> 	<span style=color:#75715e># so we don&#39;t grow a tree on top of the base</span>
<span style=color:#f92672>}</span>

init<span style=color:#f92672>(</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
	<span style=color:#111>IFS</span><span style=color:#f92672>=</span><span style=color:#d88200>$&#39;\n&#39;</span>	<span style=color:#75715e># delimit strings by newline</span>

	<span style=color:#75715e># message processing</span>
	<span style=color:#00a8c8>if</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>flag_m<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
		<span style=color:#111>declare</span> -Ag gridMessage

		<span style=color:#111>cols</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>cols <span style=color:#f92672>-</span> messageWidth <span style=color:#f92672>-</span> <span style=color:#ae81ff>8</span> <span style=color:#00a8c8>))</span> 	<span style=color:#75715e># make room for the message to go on the right side</span>
		<span style=color:#111>message</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span><span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$message</span><span style=color:#d88200>&#34;</span> <span style=color:#111>|</span> fold -sw <span style=color:#111>$messageWidth</span><span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span> 	<span style=color:#75715e># wordwrap message, delimiting by spaces</span>

		<span style=color:#75715e># get number of lines in the message</span>
		<span style=color:#111>messageLineCount</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
		<span style=color:#00a8c8>for</span> line in <span style=color:#111>$message</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
			<span style=color:#111>messageLineCount</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>messageLineCount <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#00a8c8>))</span>
		<span style=color:#00a8c8>done</span>

		<span style=color:#111>messageOffset</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>rows <span style=color:#f92672>-</span> messageLineCount <span style=color:#f92672>-</span> <span style=color:#ae81ff>7</span><span style=color:#00a8c8>))</span>

		<span style=color:#75715e># put lines of message into a grid</span>
		<span style=color:#111>index</span><span style=color:#f92672>=</span><span style=color:#111>$messageOffset</span>
		<span style=color:#00a8c8>for</span> line in <span style=color:#111>$message</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
			gridMessage<span style=color:#f92672>[</span><span style=color:#111>$index</span><span style=color:#f92672>]</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$line</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>index</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>index <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#00a8c8>))</span>
		<span style=color:#00a8c8>done</span>
	<span style=color:#00a8c8>fi</span>

	<span style=color:#75715e># add spaces before base so that it&#39;s in the middle of the terminal</span>
	<span style=color:#111>base</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;&#34;</span>
	<span style=color:#111>iter</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
	<span style=color:#00a8c8>for</span> line in <span style=color:#111>$art</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
		<span style=color:#111>filler</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;&#34;</span>
		<span style=color:#00a8c8>for</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span> <span style=color:#111>i</span><span style=color:#f92672>=</span>0<span style=color:#111>;</span> i &lt;<span style=color:#f92672>=</span> <span style=color:#f92672>(</span>cols / <span style=color:#ae81ff>2</span> - width<span style=color:#f92672>)</span><span style=color:#111>;</span> i++<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
			<span style=color:#111>filler</span><span style=color:#f92672>+=</span><span style=color:#d88200>&#34; &#34;</span>
		<span style=color:#00a8c8>done</span>
		<span style=color:#111>base</span><span style=color:#f92672>+=</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>filler</span><span style=color:#d88200>}</span><span style=color:#d88200>${</span><span style=color:#111>line</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span>
		<span style=color:#f92672>[</span> <span style=color:#111>$iter</span> -ne <span style=color:#111>$baseHeight</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>base</span><span style=color:#f92672>+=</span><span style=color:#d88200>&#39;\n&#39;</span>
		<span style=color:#111>iter</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>iter+1<span style=color:#00a8c8>))</span>
	<span style=color:#00a8c8>done</span>	
	<span style=color:#111>unset</span> IFS	<span style=color:#75715e># reset delimiter</span>

	<span style=color:#75715e># declare vars</span>
	<span style=color:#111>branches</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
	<span style=color:#111>shoots</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>

	<span style=color:#111>branchesMax</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>multiplier <span style=color:#f92672>*</span> <span style=color:#ae81ff>110</span><span style=color:#00a8c8>))</span>
	<span style=color:#111>shootsMax</span><span style=color:#f92672>=</span><span style=color:#111>$multiplier</span>

	<span style=color:#75715e># fill grid full of spaces</span>
	<span style=color:#111>declare</span> -Ag grid
	<span style=color:#00a8c8>for</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span> <span style=color:#111>row</span><span style=color:#f92672>=</span>0<span style=color:#111>;</span> row &lt;<span style=color:#f92672>=</span> rows<span style=color:#111>;</span> row++ <span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
		listChanged<span style=color:#f92672>[</span><span style=color:#111>$row</span><span style=color:#f92672>]</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
		<span style=color:#00a8c8>for</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span> <span style=color:#111>col</span><span style=color:#f92672>=</span>0<span style=color:#111>;</span> col &lt; cols<span style=color:#111>;</span> col++ <span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
			grid<span style=color:#f92672>[</span><span style=color:#111>$row</span>,<span style=color:#111>$col</span><span style=color:#f92672>]</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39; &#39;</span>
		<span style=color:#00a8c8>done</span>
	<span style=color:#00a8c8>done</span>

	<span style=color:#00a8c8>if</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>! nfetch<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
		stty -echo 		<span style=color:#75715e># don&#39;t echo stdin</span>
		<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%b&#39;</span> <span style=color:#d88200>&#39;\e[?25l\e[?7l\e[2J&#39;</span> 	<span style=color:#75715e># hide cursor, disable line wrapping, clear screen and move to 0,0</span>
	<span style=color:#00a8c8>fi</span>

	<span style=color:#75715e># setup temp file for caching times of each growth</span>
	mkdir -p /tmp/bonsai.sh
	<span style=color:#111>tmpFile</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span>mktemp -p /tmp/bonsai.sh bonsai.sh.XXXXXXXX<span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span>
<span style=color:#f92672>}</span>

grow<span style=color:#f92672>(</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
	<span style=color:#111>local</span> <span style=color:#111>x</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>cols <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#00a8c8>))</span>	<span style=color:#75715e># start halfway across the screen</span>
	<span style=color:#111>local</span> <span style=color:#111>y</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$rows</span><span style=color:#d88200>&#34;</span>		<span style=color:#75715e># start just above the base</span>
	branch <span style=color:#d88200>&#34;</span><span style=color:#111>$x</span><span style=color:#d88200>&#34;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$y</span><span style=color:#d88200>&#34;</span> trunk <span style=color:#d88200>&#34;</span><span style=color:#111>$lifeStart</span><span style=color:#d88200>&#34;</span>
<span style=color:#f92672>}</span>

branch<span style=color:#f92672>(</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
	<span style=color:#75715e># declarations</span>
	<span style=color:#111>local</span> <span style=color:#111>x</span><span style=color:#f92672>=</span><span style=color:#111>$1</span>
	<span style=color:#111>local</span> <span style=color:#111>y</span><span style=color:#f92672>=</span><span style=color:#111>$2</span>
	<span style=color:#111>local</span> <span style=color:#111>type</span><span style=color:#f92672>=</span><span style=color:#111>$3</span>
	<span style=color:#111>local</span> <span style=color:#111>life</span><span style=color:#f92672>=</span><span style=color:#111>$4</span>
	<span style=color:#111>local</span> <span style=color:#111>dx</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
	<span style=color:#111>local</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
	<span style=color:#111>local</span> <span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#f92672>)</span>


	<span style=color:#111>branches</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>branches <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#00a8c8>))</span>

	<span style=color:#75715e># as long as we&#39;re alive...</span>
	<span style=color:#00a8c8>while</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>&#34;</span> -gt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
		
		<span style=color:#111>life</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>life <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#00a8c8>))</span>	<span style=color:#75715e># ensure life ends</span>

		<span style=color:#75715e># set dy based on type</span>
		<span style=color:#00a8c8>case</span> <span style=color:#111>$type</span> in
			shoot*<span style=color:#f92672>)</span>	<span style=color:#75715e># trend horizontal/downward growth</span>
				<span style=color:#00a8c8>case</span> <span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$((</span>RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span><span style=color:#00a8c8>))</span><span style=color:#d88200>&#34;</span> in
					<span style=color:#f92672>[</span>0-1<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span>-1 <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>2-7<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>8-9<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#111>;</span><span style=color:#111>;</span>
				<span style=color:#00a8c8>esac</span>
				<span style=color:#111>;</span><span style=color:#111>;</span>

			dying<span style=color:#f92672>)</span> <span style=color:#75715e># discourage vertical growth</span>
				<span style=color:#00a8c8>case</span> <span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$((</span>RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span><span style=color:#00a8c8>))</span><span style=color:#d88200>&#34;</span> in
					<span style=color:#f92672>[</span>0-1<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span>-1 <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>2-8<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>9-10<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#111>;</span><span style=color:#111>;</span>
				<span style=color:#00a8c8>esac</span>
				<span style=color:#111>;</span><span style=color:#111>;</span>
				
			*<span style=color:#f92672>)</span>	<span style=color:#75715e># grow up/not at all</span>
				<span style=color:#111>dy</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
				<span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>&#34;</span> -ne <span style=color:#d88200>&#34;</span><span style=color:#111>$lifeStart</span><span style=color:#d88200>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#00a8c8>$((</span>RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span><span style=color:#00a8c8>))</span> -gt <span style=color:#ae81ff>2</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span>-1
				<span style=color:#111>;</span><span style=color:#111>;</span>
		<span style=color:#00a8c8>esac</span>
		<span style=color:#75715e># if we&#39;re about to hit the ground, cut it off</span>
		<span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$dy</span><span style=color:#d88200>&#34;</span> -gt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$y</span><span style=color:#d88200>&#34;</span> -gt <span style=color:#00a8c8>$((</span> rows <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#00a8c8>))</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
		<span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$type</span><span style=color:#d88200>&#34;</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;trunk&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>&#34;</span> -lt <span style=color:#ae81ff>4</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>dy</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>

		<span style=color:#75715e># set dx based on type</span>
		<span style=color:#00a8c8>case</span> <span style=color:#111>$type</span> in
			shootLeft<span style=color:#f92672>)</span>	<span style=color:#75715e># tend left: dx=[-2,1]</span>
				<span style=color:#00a8c8>case</span> <span style=color:#00a8c8>$((</span> RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span> <span style=color:#00a8c8>))</span> in
					<span style=color:#f92672>[</span>0-1<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dx</span><span style=color:#f92672>=</span>-2 <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>2-5<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dx</span><span style=color:#f92672>=</span>-1 <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>6-8<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dx</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>9<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dx</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#111>;</span><span style=color:#111>;</span>
				<span style=color:#00a8c8>esac</span> <span style=color:#111>;</span><span style=color:#111>;</span>

			shootRight<span style=color:#f92672>)</span>	<span style=color:#75715e># tend right: dx=[-1,2]</span>
				<span style=color:#00a8c8>case</span> <span style=color:#00a8c8>$((</span> RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span> <span style=color:#00a8c8>))</span> in
					<span style=color:#f92672>[</span>0-1<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dx</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>2-5<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dx</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>6-8<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dx</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>9<span style=color:#f92672>]</span><span style=color:#f92672>)</span> <span style=color:#111>dx</span><span style=color:#f92672>=</span>-1 <span style=color:#111>;</span><span style=color:#111>;</span>
				<span style=color:#00a8c8>esac</span> <span style=color:#111>;</span><span style=color:#111>;</span>

			dying<span style=color:#f92672>)</span>	<span style=color:#75715e># tend left/right: dx=[-3,3]</span>
				<span style=color:#111>dx</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span> <span style=color:#f92672>(</span>RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>7</span><span style=color:#f92672>)</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>3</span><span style=color:#00a8c8>))</span> <span style=color:#111>;</span><span style=color:#111>;</span>

			*<span style=color:#f92672>)</span>	<span style=color:#75715e># tend equal: dx=[-1,1]</span>
				<span style=color:#111>dx</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span> <span style=color:#f92672>(</span>RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>)</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#00a8c8>))</span> <span style=color:#111>;</span><span style=color:#111>;</span>

		<span style=color:#00a8c8>esac</span>

		<span style=color:#75715e># re-branch upon conditions</span>
		<span style=color:#00a8c8>if</span> <span style=color:#f92672>[</span> <span style=color:#111>$branches</span> -lt <span style=color:#111>$branchesMax</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
			
			<span style=color:#75715e># branch is dead</span>
			<span style=color:#00a8c8>if</span> <span style=color:#f92672>[</span> <span style=color:#111>$life</span> -lt <span style=color:#ae81ff>3</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
				branch <span style=color:#d88200>&#34;</span><span style=color:#111>$x</span><span style=color:#d88200>&#34;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$y</span><span style=color:#d88200>&#34;</span> dead <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>&#34;</span>

			<span style=color:#75715e># branch is dying and needs to branch into leaves</span>
			<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$type</span><span style=color:#d88200>&#34;</span> <span style=color:#f92672>=</span> trunk <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>&#34;</span> -lt <span style=color:#00a8c8>$((</span>multiplier <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span><span style=color:#00a8c8>))</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
				branch <span style=color:#d88200>&#34;</span><span style=color:#111>$x</span><span style=color:#d88200>&#34;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$y</span><span style=color:#d88200>&#34;</span> dying <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>&#34;</span>

			<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span><span style=color:#f92672>[</span> <span style=color:#111>$type</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;shoot&#34;</span>* <span style=color:#f92672>]</span><span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>&#34;</span> -lt <span style=color:#00a8c8>$((</span>multiplier <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span><span style=color:#00a8c8>))</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
				branch <span style=color:#d88200>&#34;</span><span style=color:#111>$x</span><span style=color:#d88200>&#34;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$y</span><span style=color:#d88200>&#34;</span> dying <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>&#34;</span>

			<span style=color:#75715e># re-branch if: not close to the base AND (pass a chance test OR be a trunk, not have too many shoots already, and not be about to die)</span>
			<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span><span style=color:#f92672>[</span> <span style=color:#111>$type</span> <span style=color:#f92672>=</span> trunk <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>$life</span> -lt <span style=color:#00a8c8>$((</span>lifeStart <span style=color:#f92672>-</span> <span style=color:#ae81ff>8</span><span style=color:#00a8c8>))</span> <span style=color:#8045ff>\
</span><span style=color:#8045ff></span>			<span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>(</span> <span style=color:#00a8c8>$((</span> RANDOM <span style=color:#f92672>%</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>16</span> <span style=color:#f92672>-</span> multiplier<span style=color:#f92672>)</span> <span style=color:#00a8c8>))</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#8045ff>\
</span><span style=color:#8045ff></span>			<span style=color:#f92672>||</span> <span style=color:#f92672>(</span><span style=color:#111>$type</span> <span style=color:#f92672>=</span> trunk <span style=color:#f92672>&amp;&amp;</span> <span style=color:#00a8c8>$((</span> life <span style=color:#f92672>%</span> <span style=color:#ae81ff>5</span> <span style=color:#00a8c8>))</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>$life</span> -gt 5<span style=color:#f92672>)</span> <span style=color:#f92672>)</span> <span style=color:#f92672>]</span><span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>

				<span style=color:#75715e># if a trunk is splitting and not about to die, chance to create another trunk</span>
				<span style=color:#00a8c8>if</span> <span style=color:#f92672>[</span> <span style=color:#00a8c8>$((</span>RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>3</span><span style=color:#00a8c8>))</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#111>$life</span> -gt <span style=color:#ae81ff>7</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
					branch <span style=color:#d88200>&#34;</span><span style=color:#111>$x</span><span style=color:#d88200>&#34;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$y</span><span style=color:#d88200>&#34;</span> trunk <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>&#34;</span>

				<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$shoots</span><span style=color:#d88200>&#34;</span> -lt <span style=color:#d88200>&#34;</span><span style=color:#111>$shootsMax</span><span style=color:#d88200>&#34;</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>

					<span style=color:#75715e># give the shoot some life</span>
					<span style=color:#111>tmpLife</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span> life <span style=color:#f92672>+</span> multiplier <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span> <span style=color:#00a8c8>))</span>
					<span style=color:#f92672>[</span> <span style=color:#111>$tmpLife</span> -lt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>tmpLife</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>

					<span style=color:#75715e># first shoot is randomly directed</span>	
					<span style=color:#00a8c8>if</span> <span style=color:#f92672>[</span> <span style=color:#111>$shoots</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
						<span style=color:#111>tmpType</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;shootLeft&#34;</span>
						<span style=color:#f92672>[</span> <span style=color:#00a8c8>$((</span>RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span><span style=color:#00a8c8>))</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>tmpType</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;shootRight&#34;</span>

					<span style=color:#75715e># secondary shoots alternate from the first</span>
					<span style=color:#00a8c8>else</span>
						<span style=color:#00a8c8>case</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$tmpType</span><span style=color:#d88200>&#34;</span> in
							shootLeft<span style=color:#f92672>)</span> <span style=color:#75715e># last shoot was left, shoot right</span>
								<span style=color:#111>tmpType</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;shootRight&#34;</span> <span style=color:#111>;</span><span style=color:#111>;</span>
							shootRight<span style=color:#f92672>)</span> <span style=color:#75715e># last shoot was right, shoot left</span>
								<span style=color:#111>tmpType</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;shootLeft&#34;</span> <span style=color:#111>;</span><span style=color:#111>;</span>
						<span style=color:#00a8c8>esac</span>
					<span style=color:#00a8c8>fi</span>
					branch <span style=color:#d88200>&#34;</span><span style=color:#111>$x</span><span style=color:#d88200>&#34;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$y</span><span style=color:#d88200>&#34;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$tmpType</span><span style=color:#d88200>&#34;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$tmpLife</span><span style=color:#d88200>&#34;</span>
					<span style=color:#111>shoots</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>shoots <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#00a8c8>))</span>
				<span style=color:#00a8c8>fi</span>
			<span style=color:#00a8c8>fi</span>
		<span style=color:#00a8c8>else</span> <span style=color:#75715e># we&#39;re past max branches but want to branch</span>
			<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;&lt;-&gt;&#39;</span><span style=color:#f92672>)</span>
		<span style=color:#00a8c8>fi</span>

		<span style=color:#75715e># implement dx,dy</span>
		<span style=color:#111>x</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>x <span style=color:#f92672>+</span> dx<span style=color:#00a8c8>))</span>
		<span style=color:#111>y</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>y <span style=color:#f92672>+</span> dy<span style=color:#00a8c8>))</span>
		
		<span style=color:#75715e># choose color</span>
		<span style=color:#00a8c8>case</span> <span style=color:#111>$type</span> in
			trunk<span style=color:#111>|</span>shoot*<span style=color:#f92672>)</span>
				<span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>$DarkBrown</span>
				<span style=color:#f92672>[</span> <span style=color:#00a8c8>$((</span> RANDOM <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span> <span style=color:#00a8c8>))</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>$LightBrown</span>
				<span style=color:#111>;</span><span style=color:#111>;</span>

			dying<span style=color:#f92672>)</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>$BrownGreen</span> <span style=color:#111>;</span><span style=color:#111>;</span>

			dead<span style=color:#f92672>)</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>$Green</span> <span style=color:#111>;</span><span style=color:#111>;</span>
		<span style=color:#00a8c8>esac</span>

		<span style=color:#75715e># choose branch character</span>
		<span style=color:#00a8c8>case</span> <span style=color:#111>$type</span> in
			trunk<span style=color:#f92672>)</span>
				<span style=color:#00a8c8>if</span> <span style=color:#f92672>[</span> <span style=color:#111>$dx</span> -lt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
					<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;\\&#39;</span><span style=color:#f92672>)</span>
				<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#111>$dx</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
					<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;/&#39;</span> <span style=color:#d88200>&#39;|&#39;</span><span style=color:#f92672>)</span>
				<span style=color:#00a8c8>elif</span> <span style=color:#f92672>[</span> <span style=color:#111>$dx</span> -gt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
					<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;/&#39;</span><span style=color:#f92672>)</span>
				<span style=color:#00a8c8>fi</span>
				<span style=color:#f92672>[</span> <span style=color:#111>$dy</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;/&#39;</span> <span style=color:#d88200>&#39;~&#39;</span><span style=color:#f92672>)</span>	<span style=color:#75715e># not growing</span>
				<span style=color:#75715e>#[ $dy -lt 0 ] &amp;&amp; chars=(&#39;/&#39; &#39;~&#39;)	# growing</span>
				<span style=color:#111>;</span><span style=color:#111>;</span>

			<span style=color:#75715e># shoots tend to look horizontal</span>
			shootLeft<span style=color:#f92672>)</span>
				<span style=color:#00a8c8>case</span> <span style=color:#111>$dx</span> in
					<span style=color:#f92672>[</span>-3,-1<span style=color:#f92672>]</span><span style=color:#f92672>)</span> 	<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;\\&#39;</span> <span style=color:#d88200>&#39;|&#39;</span><span style=color:#f92672>)</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span><span style=color:#f92672>)</span> 		<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;/&#39;</span> <span style=color:#d88200>&#39;|&#39;</span><span style=color:#f92672>)</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>1,3<span style=color:#f92672>]</span><span style=color:#f92672>)</span> 		<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;/&#39;</span><span style=color:#f92672>)</span> <span style=color:#111>;</span><span style=color:#111>;</span>
				<span style=color:#00a8c8>esac</span>
				<span style=color:#75715e>#[ $dy -lt 0 ] &amp;&amp; chars=(&#39;/&#39; &#39;~&#39;)	# growing up</span>
				<span style=color:#f92672>[</span> <span style=color:#111>$dy</span> -gt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;/&#39;</span><span style=color:#f92672>)</span>	<span style=color:#75715e># growing down</span>
				<span style=color:#f92672>[</span> <span style=color:#111>$dy</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;\\&#39;</span> <span style=color:#d88200>&#39;_&#39;</span><span style=color:#f92672>)</span>	<span style=color:#75715e># not growing</span>
				<span style=color:#111>;</span><span style=color:#111>;</span>

			shootRight<span style=color:#f92672>)</span>
				<span style=color:#00a8c8>case</span> <span style=color:#111>$dx</span> in
					<span style=color:#f92672>[</span>-3,-1<span style=color:#f92672>]</span><span style=color:#f92672>)</span> 	<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;\\&#39;</span> <span style=color:#d88200>&#39;|&#39;</span><span style=color:#f92672>)</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span><span style=color:#f92672>)</span> 		<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;/&#39;</span> <span style=color:#d88200>&#39;|&#39;</span><span style=color:#f92672>)</span> <span style=color:#111>;</span><span style=color:#111>;</span>
					<span style=color:#f92672>[</span>1,3<span style=color:#f92672>]</span><span style=color:#f92672>)</span> 		<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;/&#39;</span><span style=color:#f92672>)</span> <span style=color:#111>;</span><span style=color:#111>;</span>
				<span style=color:#00a8c8>esac</span>
				<span style=color:#75715e>#[ $dy -lt 0 ] &amp;&amp; chars=(&#39;&#39;)	# growing up</span>
				<span style=color:#f92672>[</span> <span style=color:#111>$dy</span> -gt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;\\&#39;</span><span style=color:#f92672>)</span>	<span style=color:#75715e># growing down</span>
				<span style=color:#f92672>[</span> <span style=color:#111>$dy</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#39;_&#39;</span> <span style=color:#d88200>&#39;/&#39;</span><span style=color:#f92672>)</span>	<span style=color:#75715e># not growing</span>
				<span style=color:#111>;</span><span style=color:#111>;</span>
		<span style=color:#00a8c8>esac</span>

		<span style=color:#75715e># randomly choose leaf character</span>
		<span style=color:#00a8c8>if</span> <span style=color:#f92672>[</span> <span style=color:#111>$life</span> -lt <span style=color:#ae81ff>4</span> <span style=color:#f92672>]</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
			<span style=color:#111>chars</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#f92672>)</span>
			<span style=color:#111>randIndex</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>RANDOM <span style=color:#f92672>%</span> leafArrayLen<span style=color:#00a8c8>))</span>

			<span style=color:#75715e># add each char in our randomly chosen list to our chars</span>
			<span style=color:#00a8c8>for</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span> <span style=color:#111>i</span><span style=color:#f92672>=</span>0<span style=color:#111>;</span> i &lt; <span style=color:#d88200>${</span><span style=color:#111>leafArray</span><span style=color:#111>[</span><span style=color:#111>$randIndex</span><span style=color:#111>,0]</span><span style=color:#d88200>}</span><span style=color:#111>;</span> i++<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
				<span style=color:#111>chars</span><span style=color:#f92672>+=</span><span style=color:#f92672>(</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>leafArray</span><span style=color:#111>[</span><span style=color:#111>$randIndex</span><span style=color:#111>,</span><span style=color:#00a8c8>$((</span>i+1<span style=color:#00a8c8>))</span><span style=color:#111>]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span><span style=color:#f92672>)</span>
			<span style=color:#00a8c8>done</span>
		<span style=color:#00a8c8>fi</span>
		<span style=color:#75715e># [ $life -eq 0 ] &amp;&amp; chars=(&#39;&amp;&#39; &#39;&amp;&#39;) 	# eh, maybe</span>

		<span style=color:#f92672>(</span><span style=color:#f92672>(</span>verbose<span style=color:#f92672>)</span><span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>printf</span> <span style=color:#d88200>&#39;%b\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$life</span><span style=color:#d88200>:\\t</span><span style=color:#111>$x</span><span style=color:#d88200>, </span><span style=color:#111>$y</span><span style=color:#d88200>: </span><span style=color:#111>$char</span><span style=color:#d88200>&#34;</span>
		
		<span style=color:#75715e># add this/these character(s) to our grid</span>
		<span style=color:#111>index</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
		<span style=color:#00a8c8>for</span> char in <span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>chars</span><span style=color:#111>[@]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
			<span style=color:#111>newX</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>x+index<span style=color:#00a8c8>))</span>
			grid<span style=color:#f92672>[</span><span style=color:#111>$y</span>,<span style=color:#111>$newX</span><span style=color:#f92672>]</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>color</span><span style=color:#d88200>}</span><span style=color:#d88200>${</span><span style=color:#111>char</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span>

			<span style=color:#75715e># ensure we keep track of last column</span>
			<span style=color:#f92672>[</span> <span style=color:#d88200>${</span><span style=color:#111>y</span><span style=color:#00a8c8>:-</span><span style=color:#111>0</span><span style=color:#d88200>}</span> -gt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> -n <span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>listChanged</span><span style=color:#111>[</span><span style=color:#111>$y</span><span style=color:#111>]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#d88200>${</span><span style=color:#111>newX</span><span style=color:#00a8c8>:-</span><span style=color:#111>0</span><span style=color:#d88200>}</span> -gt <span style=color:#d88200>${</span><span style=color:#111>listChanged</span><span style=color:#111>[</span><span style=color:#111>$y</span><span style=color:#111>]</span><span style=color:#d88200>}</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> listChanged<span style=color:#f92672>[</span><span style=color:#111>$y</span><span style=color:#f92672>]</span><span style=color:#f92672>=</span><span style=color:#111>$newX</span>
			<span style=color:#111>index</span><span style=color:#f92672>=</span><span style=color:#00a8c8>$((</span>index+1<span style=color:#00a8c8>))</span>
		<span style=color:#00a8c8>done</span>

		<span style=color:#75715e># print what we have so far</span>
		<span style=color:#00a8c8>if</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>live<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
			<span style=color:#f92672>(</span> <span style=color:#111>time</span> -p display <span style=color:#f92672>)</span> 2&gt;<span style=color:#d88200>&#34;</span><span style=color:#111>$tmpFile</span><span style=color:#d88200>&#34;</span>
			<span style=color:#111>elapsed</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span>head <span style=color:#d88200>&#34;</span><span style=color:#111>$tmpFile</span><span style=color:#d88200>&#34;</span> -n <span style=color:#ae81ff>1</span> <span style=color:#111>|</span> awk <span style=color:#d88200>&#39;{print $2}&#39;</span> <span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span>
			<span style=color:#75715e># if this step took less than $stepTime, sleep until $stepTime is met</span>
			<span style=color:#111>timeLeft</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span><span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$timeStep</span><span style=color:#d88200> - </span><span style=color:#111>$elapsed</span><span style=color:#d88200>&#34;</span> <span style=color:#111>|</span> bc -l<span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span>
			<span style=color:#f92672>[</span> <span style=color:#d88200>&#34;</span><span style=color:#00a8c8>$(</span><span style=color:#111>printf</span> <span style=color:#d88200>&#39;%s\n&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#d88200>(</span><span style=color:#111>$timeLeft</span><span style=color:#d88200>) &gt; 0</span><span style=color:#d88200>&#34;</span> <span style=color:#111>|</span> bc -l<span style=color:#00a8c8>)</span><span style=color:#d88200>&#34;</span> -eq <span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> sleep <span style=color:#d88200>&#34;</span><span style=color:#111>$timeLeft</span><span style=color:#d88200>&#34;</span>
		<span style=color:#00a8c8>fi</span>
	<span style=color:#00a8c8>done</span>	
<span style=color:#f92672>}</span>

display<span style=color:#f92672>(</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
	<span style=color:#75715e># parse grid for output</span>
	<span style=color:#111>output</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;&#34;</span>
	<span style=color:#00a8c8>for</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span> <span style=color:#111>row</span><span style=color:#f92672>=</span>0<span style=color:#111>;</span> row &lt; rows<span style=color:#111>;</span> row++<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
		<span style=color:#111>lineArray</span><span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#f92672>)</span>

		<span style=color:#75715e># only parse to the last known column with a char in it</span>
		<span style=color:#00a8c8>for</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span> <span style=color:#111>col</span><span style=color:#f92672>=</span>0<span style=color:#111>;</span> col &lt;<span style=color:#f92672>=</span> listChanged<span style=color:#f92672>[</span>row<span style=color:#f92672>]</span><span style=color:#111>;</span> col++ <span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>

			<span style=color:#f92672>(</span><span style=color:#f92672>(</span>live<span style=color:#f92672>)</span><span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>printf</span> <span style=color:#d88200>&#39;%b&#39;</span> <span style=color:#d88200>&#39;\e[0;0H&#39;</span> 	<span style=color:#75715e># move cursor to 00</span>

			<span style=color:#75715e># grab the character from our grid</span>
			lineArray<span style=color:#f92672>[</span><span style=color:#d88200>&#34;</span><span style=color:#111>$col</span><span style=color:#d88200>&#34;</span><span style=color:#f92672>]</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>$row</span><span style=color:#111>,</span><span style=color:#111>$col</span><span style=color:#111>]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span>
		<span style=color:#00a8c8>done</span>
		<span style=color:#111>line</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>lineArray</span><span style=color:#111>[*]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span> 	<span style=color:#75715e># combine array elements into a string</span>

		<span style=color:#00a8c8>if</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>flag_m<span style=color:#f92672>)</span><span style=color:#f92672>)</span> <span style=color:#f92672>||</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>nfetch<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
			<span style=color:#111>line</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>line</span><span style=color:#111>%</span><span style=color:#d88200>${</span><span style=color:#111>line</span><span style=color:#111>##*[^[</span><span style=color:#111>:</span><span style=color:#111>space</span><span style=color:#111>:</span><span style=color:#111>]]</span><span style=color:#d88200>}</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span> 	<span style=color:#75715e># remove trailing whitespace and reset color</span>
		<span style=color:#00a8c8>fi</span>

		<span style=color:#75715e># add our message unless line is blank</span>
		<span style=color:#f92672>(</span><span style=color:#f92672>(</span>flag_m<span style=color:#f92672>)</span><span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> ! <span style=color:#d88200>&#34;</span><span style=color:#111>$line</span><span style=color:#d88200>&#34;</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>line</span><span style=color:#f92672>+=</span><span style=color:#d88200>&#39;   \t&#39;</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>R</span><span style=color:#d88200>}</span><span style=color:#d88200>${</span><span style=color:#111>gridMessage</span><span style=color:#111>[</span><span style=color:#111>$row</span><span style=color:#111>]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span>

		<span style=color:#111>IFS</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;&#39;</span>
		<span style=color:#111>output</span><span style=color:#f92672>+=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$line</span><span style=color:#d88200>\\n</span><span style=color:#d88200>&#34;</span>
	<span style=color:#00a8c8>done</span>

	<span style=color:#111>output</span><span style=color:#f92672>+=</span><span style=color:#d88200>&#34;</span><span style=color:#111>$base</span><span style=color:#d88200>&#34;</span> 	<span style=color:#75715e># add the ascii-art base we generated earlier</span>	
	<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%b&#39;</span> <span style=color:#d88200>&#34;</span><span style=color:#111>$output</span><span style=color:#d88200>&#34;</span>
<span style=color:#f92672>}</span>

quit<span style=color:#f92672>(</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
	<span style=color:#00a8c8>if</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>! nfetch<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>then</span>
		stty <span style=color:#111>echo</span> 	<span style=color:#75715e># echo stdin</span>
		<span style=color:#111>printf</span> <span style=color:#d88200>&#39;%b\n&#39;</span> <span style=color:#d88200>&#39;\e[?25h\e[?7h&#39;</span><span style=color:#d88200>&#34;</span><span style=color:#d88200>${</span><span style=color:#111>R</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;</span> 	<span style=color:#75715e># show cursor, enable line wrapping, reset colors</span>
		tabs <span style=color:#ae81ff>8</span>
	<span style=color:#00a8c8>else</span>
		<span style=color:#111>printf</span> <span style=color:#d88200>&#39;\n&#39;</span> 	<span style=color:#75715e># reset formatting, put cursor on next line</span>
	<span style=color:#00a8c8>fi</span>
	<span style=color:#111>exit</span> <span style=color:#ae81ff>0</span>
<span style=color:#f92672>}</span>

bonsai<span style=color:#f92672>(</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
	setGeometry
	init
	grow
	display
<span style=color:#f92672>}</span>

main<span style=color:#f92672>(</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
	bonsai
	<span style=color:#00a8c8>while</span> <span style=color:#f92672>(</span><span style=color:#f92672>(</span>infinite<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#111>;</span> <span style=color:#00a8c8>do</span>
		sleep <span style=color:#d88200>&#34;</span><span style=color:#111>$timeWait</span><span style=color:#d88200>&#34;</span>
		bonsai
	<span style=color:#00a8c8>done</span>
<span style=color:#f92672>}</span>

main
quit
</code></pre></div></article><footer class=book-footer><div class="flex justify-between"><div><a class="flex align-center" href=https://github.com/hellupline/hellupline.github.io-source/commit/e78f7dabc428f2e253ea236edec0e9917d09f5ae title="Last modified by Renan Traba | Nov 4, 2022" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>Nov 4, 2022</span></a></div><div><a class="flex align-center" href=https://github.com/hellupline/hellupline.github.io-source/edit/master/content/docs/scripts/toys/bonsai.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents></nav></aside></main></body></html>